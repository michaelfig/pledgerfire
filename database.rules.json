{
    "rules": {
	"users": {
	    "$user_id": {
		".read": "auth != null && $user_id === auth.uid",
		".write": "auth != null && $user_id === auth.uid"
	    }
	},
	"audit": {
	    "$user_id": {
		".read": "auth != null && $user_id === auth.uid",
		"$message_id": {
		    ".write": "!data.exists() && newData.exists()",
		    ".validate": "newData.hasChildren(['stamp', 'title', 'user', 'category', 'lat', 'long', 'acc'])",
		    "stamp": { ".validate": "newData.val() === now" },
		    "user": { ".validate": "newData.val() === $user_id" },
		    "title": { ".validate": "newData.isString() && newData.val().length < 256" },
		    "category": { ".validate": "newData.isString() && newData.val().length < 256" },
		    "since": { ".validate": "!newData.exists() || (newData.isNumber() && newData.val() < newData.child('stamp').val())" },
		    "lat": { ".validate": "newData.isNumber() && newData.val() > -90 && newData.val() < 90" },
		    "long": { ".validate": "newData.isNumber() && newData.val() > -180 && newData.val() < 180" },
		    "acc": { ".validate": "newData.isNumber() && newData.val() >= 0" },
		    "$other": { ".validate": false },
		    ".indexOn": ["stamp"]
		}
	    }
	}
    }
}
